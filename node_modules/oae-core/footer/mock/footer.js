
define(function(require) {

  var footer = require('widget!footer');

  describe('Bottom Widget', function(){

    describe('Manifest', function() {
      it('should exist', function(){
        footer.manifest.should.be.ok;
      })
      it('should not be empty', function(){
        footer.manifest.should.not.be.empty;
      })
      it('should include a URL for the HTML template', function(){
        footer.manifest.src.should.be.ok;
      })
    })

    describe('HTML Template', function(){
      it('should exist', function(){
        footer.html.should.be.ok;
      })
      it('should not be empty', function(){
        footer.html.should.not.be.empty;
      })
      it('should include exactly one CSS style sheet', function(){
        footer.cssStyleSheets.should.have.length.of(1);
      })
      it('should include exactly one external JavaScript file', function(){
        footer.jsScripts.should.have.length.of(1);
      })
    })

    describe('CSS Style Sheet', function(){
      it ('should not be empty', function(){
        footer.cssStyleSheets[0].content.should.not.be.empty;
      })
    })

    describe('JavaScript Module', function(){
      it ('should not be empty', function(){
        footer.jsScripts[0].content.should.not.be.empty;
      })
      it('should return a function', function() {
        footer.jsScripts[0].content.should.be.a('function');
      })
    })

    describe('Static Rendering', function() {
      beforeEach(function() {
        footer.load();
      })
      afterEach(function() {
        footer.unload();
      })

      // Note: These tests are copied from the casperjs functional
      // tests residing (as of this writing) in a pull request.
      // For reference, here are the original tests, reformatted
      // slightly to shorten line lengths:
      //
      //     var verifyFooter = function() {
      //         // Verify that the footer exists on the page
      //         casper.test.assertExists(
      //             '#footer-container',
      //             'The footer exists on the page'
      //         );
      //         // Verify that the footer has a link
      //         casper.test.assertExists(
      //             '#footer-container a[href="http://apereo.org/"]',
      //             'The footer has a link to the Apereo website'
      //         );
      //         // Verify that the footer link opens in a new tab
      //         casper.test.assertExists(
      //             '#footer-container a[href="http://apereo.org/"][target="_blank"]',
      //             'The footer link opens in a new tab'
      //         );
      //     };

      it('should insert a footer container on the page', function() {
        $('#footer-container').should.exist;
      })
      it ('should include a link to the Apero website', function() {
        $('#footer-container a[href="http://apereo.org/"]').should.exist;
      })
      it ('should open link in new window/tab', function() {
        $('#footer-container a[href="http://apereo.org/"][target="_blank"]').should.exist;
      })
    })

    describe('JavaScript Execution', function() {
      beforeEach(function() {
        footer.load();
      })
      afterEach(function() {
        footer.unload();
      })
      it('should insert current year in copyright notice', function() {
        $('#footer-date').should.have.text(new Date().getFullYear().toString());
      })
    })

  })
});

